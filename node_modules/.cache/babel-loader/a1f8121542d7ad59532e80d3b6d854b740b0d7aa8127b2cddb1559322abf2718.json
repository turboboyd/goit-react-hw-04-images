{"ast":null,"code":"import _toConsumableArray from\"C:/Users/denis/Project/goit-react-hw-03-image-finder/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"C:/Users/denis/Project/goit-react-hw-03-image-finder/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/denis/Project/goit-react-hw-03-image-finder/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/denis/Project/goit-react-hw-03-image-finder/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/denis/Project/goit-react-hw-03-image-finder/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import css from'./ImageGallery.module.css';import{fetchImages}from'../../servises/api-images.js';import{ImageGalleryItem}from'components/ImageGalleryItem/ImageGalleryItem';import{Button}from'components/Button/Button';import{Loader}from'components/Loader/Loader';import{Modal}from'../Modal/Modal';import{warnNoImages,noImagesFound,errorToastify}from'../Notifix/Notifix';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ImageGallery=/*#__PURE__*/function(_Component){_inherits(ImageGallery,_Component);var _super=_createSuper(ImageGallery);function ImageGallery(){var _this;_classCallCheck(this,ImageGallery);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={searchName:'',images:[],page:1,loading:false,error:null,status:'idle',showButton:false,showModal:false,selectedImageUrl:'',alt:''};_this.handleLoadMore=function(){var page=_this.state.page;var name=_this.props.searchName.searchName;fetchImages(name,page).then(function(newImages){_this.setState({images:[].concat(_toConsumableArray(_this.state.images),_toConsumableArray(newImages.hits)),page:page+1,status:'resolved',loading:false});if(Math.ceil(newImages.totalHits/12)===page){warnNoImages();_this.setState({showButton:false});}}).catch(function(error){return _this.setState({error:error,status:'rejected',loading:false});});};_this.openModal=function(imageUrl,tags){_this.setState({showModal:true,selectedImageUrl:imageUrl,alt:tags});};_this.closeModal=function(){_this.setState({showModal:false,selectedImageUrl:''});};return _this;}_createClass(ImageGallery,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this2=this;var prevName=prevProps.searchName;var newName=this.props.searchName;if(prevName!==newName){this.setState({status:'pending'});var page=1;setTimeout(function(){fetchImages(newName.searchName,page).then(function(newImages){if(newImages.hits.length===0){noImagesFound(newName);return _this2.setState({status:'idle',loading:false});}_this2.setState({images:newImages.hits,page:page+1,status:'resolved',loading:false,showButton:true});if(Math.ceil(newImages.totalHits/12)===page){warnNoImages();_this2.setState({showButton:false});}}).catch(function(error){return _this2.setState({error:error,status:'rejected',loading:false});});},1000);}}},{key:\"render\",value:function render(){var _this$state=this.state,images=_this$state.images,status=_this$state.status,showButton=_this$state.showButton,showModal=_this$state.showModal,selectedImageUrl=_this$state.selectedImageUrl,alt=_this$state.alt;var openModal=this.openModal,handleLoadMore=this.handleLoadMore,closeModal=this.closeModal;if(status==='pending'){return/*#__PURE__*/_jsx(Loader,{});}if(status==='rejected'){errorToastify();return/*#__PURE__*/_jsx(\"div\",{children:\"An error has occurred, please try again!\"});}if(status==='resolved'){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:css.ImageGallery,children:images.map(function(_ref){var id=_ref.id,largeImageURL=_ref.largeImageURL,tags=_ref.tags;return/*#__PURE__*/_jsx(ImageGalleryItem,{src:largeImageURL,alt:tags,onClick:function onClick(){return openModal(largeImageURL,tags);}},id);})}),showButton&&/*#__PURE__*/_jsx(Button,{onClick:handleLoadMore,children:\"Load more\"}),showModal&&/*#__PURE__*/_jsx(Modal,{imageUrl:selectedImageUrl,alt:alt,onClose:closeModal})]});}}}]);return ImageGallery;}(Component);","map":{"version":3,"sources":["C:/Users/denis/Project/goit-react-hw-03-image-finder/src/components/ImageGallery/ImageGallery.jsx"],"names":["React","Component","css","fetchImages","ImageGalleryItem","Button","Loader","Modal","warnNoImages","noImagesFound","errorToastify","ImageGallery","state","searchName","images","page","loading","error","status","showButton","showModal","selectedImageUrl","alt","handleLoadMore","name","props","then","newImages","setState","hits","Math","ceil","totalHits","catch","openModal","imageUrl","tags","closeModal","prevProps","prevState","prevName","newName","setTimeout","length","map","id","largeImageURL"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport css from './ImageGallery.module.css';\r\nimport {fetchImages} from '../../servises/api-images.js';\r\nimport { ImageGalleryItem } from 'components/ImageGalleryItem/ImageGalleryItem';\r\nimport { Button } from 'components/Button/Button';\r\nimport { Loader } from 'components/Loader/Loader';\r\nimport {Modal} from '../Modal/Modal';\r\nimport { warnNoImages, noImagesFound, errorToastify } from '../Notifix/Notifix';\r\nimport PropTypes from 'prop-types';\r\n\r\n  export class ImageGallery extends Component {\r\n    state = {\r\n      searchName: '',\r\n      images: [],\r\n      page: 1,\r\n      loading: false,\r\n      error: null,\r\n      status: 'idle',\r\n      showButton: false,\r\n      showModal: false,\r\n      selectedImageUrl: '',\r\n      alt: '',\r\n    };\r\n\r\n    static propTypes = {\r\n      searchName: PropTypes.object.isRequired,\r\n    };\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n      const prevName = prevProps.searchName;\r\n      const newName = this.props.searchName;\r\n      if (prevName !== newName) {\r\n        this.setState({ status: 'pending' });\r\n        const page = 1;\r\n        setTimeout(() => {\r\n          fetchImages(newName.searchName, page)\r\n            .then(newImages => {\r\n              if (newImages.hits.length === 0) {\r\n                noImagesFound(newName);\r\n                return this.setState({\r\n                  status: 'idle',\r\n                  loading: false,\r\n                });\r\n              }\r\n              this.setState({\r\n                images: newImages.hits,\r\n                page: page + 1,\r\n                status: 'resolved',\r\n                loading: false,\r\n                showButton: true,\r\n              });\r\n\r\n              if (Math.ceil(newImages.totalHits / 12) === page) {\r\n                warnNoImages();\r\n                this.setState({\r\n                  showButton: false,\r\n                });\r\n              }\r\n            })\r\n            .catch(error =>\r\n              this.setState({ error, status: 'rejected', loading: false })\r\n            );\r\n        }, 1000);\r\n      }\r\n    }\r\n\r\n    handleLoadMore = () => {\r\n      const page = this.state.page;\r\n      const name = this.props.searchName.searchName;\r\n      fetchImages(name, page)\r\n        .then(newImages => {\r\n          this.setState({\r\n            images: [...this.state.images, ...newImages.hits],\r\n            page: page + 1,\r\n            status: 'resolved',\r\n            loading: false,\r\n          });\r\n          if (Math.ceil(newImages.totalHits / 12) === page) {\r\n            warnNoImages();\r\n            this.setState({\r\n              showButton: false,\r\n            });\r\n          }\r\n        })\r\n        .catch(error =>\r\n          this.setState({ error, status: 'rejected', loading: false })\r\n        );\r\n    };\r\n\r\n    openModal = (imageUrl, tags) => {\r\n      this.setState({ showModal: true, selectedImageUrl: imageUrl, alt: tags });\r\n    };\r\n\r\n    closeModal = () => {\r\n      this.setState({ showModal: false, selectedImageUrl: '' });\r\n    };\r\n\r\n    render() {\r\n      const { images, status, showButton, showModal, selectedImageUrl, alt } =\r\n        this.state;\r\n      const { openModal, handleLoadMore, closeModal } = this;\r\n\r\n      if (status === 'pending') {\r\n        return <Loader />;\r\n      }\r\n\r\n      if (status === 'rejected') {\r\n        errorToastify();\r\n        return <div>An error has occurred, please try again!</div>;\r\n      }\r\n\r\n      if (status === 'resolved') {\r\n        return (\r\n          <>\r\n            <ul className={css.ImageGallery}>\r\n              {images.map(({ id, largeImageURL, tags }) => (\r\n                <ImageGalleryItem\r\n                  key={id}\r\n                  src={largeImageURL}\r\n                  alt={tags}\r\n                  onClick={() => openModal(largeImageURL, tags)}\r\n                />\r\n              ))}\r\n            </ul>\r\n            {showButton && <Button onClick={handleLoadMore}>Load more</Button>}\r\n\r\n            {showModal && (\r\n              <Modal\r\n                imageUrl={selectedImageUrl}\r\n                alt={alt}\r\n                onClose={closeModal}\r\n              />\r\n            )}\r\n          </>\r\n        );\r\n      }\r\n    }\r\n  }\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}